<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="keywords" content="bregier, fichier, file, frederic, gateway, goldengate, http, java, libre, moniteur, monitor, open, openr66, route, source, ssh, transfer, transfert, waarp" />
<meta name="robots" content="index,follow" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="description" content="Waarp project" />
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1" />
<meta name="generator" content="Site Studio 6 (www.effectivestudios.com)" />
<link rel="stylesheet" href="Waarp.css" type="text/css" />
<style type="text/css">
a {
	color:#0000FF;
	text-decoration:none;
}
a:visited {
	text-decoration:none;
}
a:hover {
	text-decoration:underline;
}
a img {
	border:#000000 0px none;
}
</style>
<title>Waarp - R66Cluster-HA</title>
	<script type="text/javascript">
//<![CDATA[
	function MHGetRef(str)
	{
		if(document.all)
			return document.all[str];
		else
			return document.getElementById(str);
	}

	function MHSwitchImage(strID, strFileName)
	{
		var obj = MHGetRef(strID);
		if(obj == null || obj + "" == "undefined") return;
		obj.src = strFileName;
	}
//]]>
	</script>
<script type="text/javascript">
//<![CDATA[
	function mvgGetRef(str)						{ return (document.all) ? document.all[str] : document.getElementById(str); }
	function mvgSetClass(strId, strClass)		{ var obj = mvgGetRef(strId); if(obj != null && typeof(obj) != "undefined") obj.className = strClass; }
	function mvgSwitchImage(strId, strFileName)	{ var obj = mvgGetRef(strId); if(obj != null && typeof(obj) != "undefined") obj.src = strFileName; }
//]]>
</script>
</head>
<body class="normal" style="margin:0px;padding:0px;background-color:#FFFFFF;background-image:url(gre/gre10088.png);background-position:left top;background-repeat:repeat-y;">
<div style="text-align:left;">
<div style="background-color:#EF6D00;text-align:left;"><a href="index.html"><img title="GoldenGate" style="border:none;" height="49" alt="GoldenGate" src="res/openlsd/waarp.jpg" width="74" /></a><img title="Waarp" style="border-top-style:none; border-bottom:#000000 0px solid; border-right-style:none; border-left-style:none;" height="40" alt="Waarp" src="gre/gre10089.png" width="99" /></div>
<div style="border-right:none;border-left:none;border-bottom:2px solid #FFFFFF;border-top:1px solid #FFFFFF;background-color:#F9DEC7;text-align:left;"><table cellpadding="0" cellspacing="0" border="0" style="width:100%;margin:0;padding:0;border:0 solid none;"><tr><td style="vertical-align:top;"><div></div></td><td style="height:1px;width:1px;margin:0;padding:0;border:0 solid none;"><div style="height:1px;width:1px;margin:0;padding:0;border:0 solid none;"></div></td></tr></table></div>
<table style="border:none;" cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<td style="vertical-align:top;width:100px;background-color:#FFFFFF;">&nbsp;</td>
<td style="padding-right:5px;padding-left:5px;padding-bottom:0px;vertical-align:top;width:100%;padding-top:0px;">
<div id="Comp4_MenuHorizontal">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
	<tr style="background-image:url(gre/gre10057.png);background-repeat:repeat-x;background-position:left top;">
		<td id="MH1_0"><a href="WaarpR66Presentation.html" onmouseover="MHSwitchImage('MH1_0_img', 'gre/gre10101.png');" onmouseout="MHSwitchImage('MH1_0_img', 'gre/gre10100.png');"><img id="MH1_0_img" src="gre/gre10100.png" width="179" height="26" alt="Waarp R66-Presentation" style="border:none;display:block;" /></a></td>
		<td></td><td><img src="gre/gre10056.png" height="18" width="1" style="border:none;display:block;" alt="" /></td><td></td>
		<td id="MH1_1"><a href="WaarpR66Installation.html" onmouseover="MHSwitchImage('MH1_1_img', 'gre/gre10103.png');" onmouseout="MHSwitchImage('MH1_1_img', 'gre/gre10102.png');"><img id="MH1_1_img" src="gre/gre10102.png" width="171" height="26" alt="Waarp R66-Installation" style="border:none;display:block;" /></a></td>
		<td></td><td><img src="gre/gre10056.png" height="18" width="1" style="border:none;display:block;" alt="" /></td><td></td>
		<td id="MH1_2"><a href="WaarpR66Technical.html" onmouseover="MHSwitchImage('MH1_2_img', 'gre/gre10105.png');" onmouseout="MHSwitchImage('MH1_2_img', 'gre/gre10105.png');"><img id="MH1_2_img" src="gre/gre10105.png" width="175" height="26" alt="Waarp R66-Technical" style="border:none;display:block;" /></a></td>
		<td></td><td><img src="gre/gre10056.png" height="18" width="1" style="border:none;display:block;" alt="" /></td><td></td>
		<td id="MH1_3"><a href="WaarpR66Production.html" onmouseover="MHSwitchImage('MH1_3_img', 'gre/gre10107.png');" onmouseout="MHSwitchImage('MH1_3_img', 'gre/gre10106.png');"><img id="MH1_3_img" src="gre/gre10106.png" width="167" height="26" alt="Waarp R66-Production" style="border:none;display:block;" /></a></td>
		<td></td><td><img src="gre/gre10056.png" height="18" width="1" style="border:none;display:block;" alt="" /></td><td></td>
		<td id="MH1_4"><a href="WaarpAdministrator.html" onmouseover="MHSwitchImage('MH1_4_img', 'gre/gre10109.png');" onmouseout="MHSwitchImage('MH1_4_img', 'gre/gre10108.png');"><img id="MH1_4_img" src="gre/gre10108.png" width="156" height="26" alt="Waarp Administrator" style="border:none;display:block;" /></a></td>
		<td style="width:100%;"><img src="img/space.gif" width="1" height="1" style="border:none;display:block;" alt="" /></td>
	<td><img src="gre/gre10057.png" height="26" width="1" style="border:none;display:block;" alt="" /></td>
	</tr>
</table>
</div></td></tr>
<tr>
<td style="vertical-align:top;width:100px;">
<div id="Comp6_MenuVertical" style="text-align:left;"><div id="mvg1"><a href="index.html" onmouseover="mvgSwitchImage('mvg1_0_img', 'gre/gre10060.png');" onmouseout="mvgSwitchImage('mvg1_0_img', 'gre/gre10058.png');"><img id="mvg1_0_img" src="gre/gre10058.png" width="150" height="31" alt="Home" style="display:block;border:none;" /></a>
<a href="WorldofWaarp.html" onmouseover="mvgSwitchImage('mvg1_1_img', 'gre/gre10063.png');" onmouseout="mvgSwitchImage('mvg1_1_img', 'gre/gre10061.png');"><img id="mvg1_1_img" src="gre/gre10061.png" width="150" height="31" alt="World of Waarp" style="display:block;border:none;" /></a>
<a href="WaarpR66.html" onmouseover="mvgSwitchImage('mvg1_2_img', 'gre/gre10066.png');" onmouseout="mvgSwitchImage('mvg1_2_img', 'gre/gre10065.png');"><img id="mvg1_2_img" src="gre/gre10065.png" width="150" height="31" alt="Waarp R66" style="display:block;border:none;" /></a>
<a href="WaarpFTP.html" onmouseover="mvgSwitchImage('mvg1_3_img', 'gre/gre10069.png');" onmouseout="mvgSwitchImage('mvg1_3_img', 'gre/gre10067.png');"><img id="mvg1_3_img" src="gre/gre10067.png" width="150" height="31" alt="Waarp FTP" style="display:block;border:none;" /></a>
<a href="WaarpGatewayFtp.html" onmouseover="mvgSwitchImage('mvg1_4_img', 'gre/gre10072.png');" onmouseout="mvgSwitchImage('mvg1_4_img', 'gre/gre10070.png');"><img id="mvg1_4_img" src="gre/gre10070.png" width="150" height="31" alt="WaarpGatewayFtp" style="display:block;border:none;" /></a>
<a href="WaarpGatewayHttp.html" onmouseover="mvgSwitchImage('mvg1_5_img', 'gre/gre10075.png');" onmouseout="mvgSwitchImage('mvg1_5_img', 'gre/gre10073.png');"><img id="mvg1_5_img" src="gre/gre10073.png" width="150" height="31" alt="WaarpGatewayHttp" style="display:block;border:none;" /></a>
<a href="WaarpCommons.html" onmouseover="mvgSwitchImage('mvg1_6_img', 'gre/gre10078.png');" onmouseout="mvgSwitchImage('mvg1_6_img', 'gre/gre10076.png');"><img id="mvg1_6_img" src="gre/gre10076.png" width="150" height="31" alt="Waarp Commons" style="display:block;border:none;" /></a>
<a href="APIReferences.html" onmouseover="mvgSwitchImage('mvg1_7_img', 'gre/gre10081.png');" onmouseout="mvgSwitchImage('mvg1_7_img', 'gre/gre10079.png');"><img id="mvg1_7_img" src="gre/gre10079.png" width="150" height="31" alt="API References" style="display:block;border:none;" /></a>
<a href="Downloads.html" onmouseover="mvgSwitchImage('mvg1_8_img', 'gre/gre10084.png');" onmouseout="mvgSwitchImage('mvg1_8_img', 'gre/gre10082.png');"><img id="mvg1_8_img" src="gre/gre10082.png" width="150" height="31" alt="Downloads" style="display:block;border:none;" /></a>
<a href="WaarpDependson.html" onmouseover="mvgSwitchImage('mvg1_9_img', 'gre/gre10087.png');" onmouseout="mvgSwitchImage('mvg1_9_img', 'gre/gre10085.png');"><img id="mvg1_9_img" src="gre/gre10085.png" width="150" height="31" alt="Waarp Depends on" style="display:block;border:none;" /></a>
</div></div></td>
<td style="padding-right:5px;padding-left:5px;padding-bottom:5px;vertical-align:top;width:100%;padding-top:5px;">
<h1 class="h1">R66Cluster-HA</h1>
<div id="Comp1_sys_doctext"><h1 class="h1" style="text-align:justify;">Cluster configuration and High availability consideration</h1>
<p style="text-align:justify;"><span style="font-size:11pt;">The cluster principle for Waarp R66 is as the following:</span></p>
<ul>
<li><p style="text-align:justify;"><span style="font-size:11pt;">Having a load balancer, based on TCP, allowing to maintain an open connection to stay open, and to balance new connection with a pool of R66 servers, using probably the less connection as elected</span></p></li>

<li><p style="text-align:justify;"><span style="font-size:11pt;">The IP/port of the load balancer service is the R66 service address associated with the pool of servers</span></p></li>

<li><p style="text-align:justify;"><span style="font-size:11pt;">If the load balancer is transparent, the IP of the client is visible from the R66 servers in the pool. If the load balancer is not transparent, the IP of the client is replaced by the IP of the load balancer itself, therefore the R66 servers in the poll will not be able to check the IP addresses of the partners.</span></p></li>

<li>
<p style="text-align:justify;"><span style="font-size:11pt;">All servers in the pool will have the exact same IDs (SSL and not SSL), sharing the same database, the same filesystem sub part (work, out at least, probably also in, arch and conf). The configuration must set the multiplemonitor to the number of total available servers in the pool (at most available).</span></p></li></ul>
<p style="text-align:justify;"><span style="font-size:11pt;">This should enable high availability on the following:</span></p>
<ul>
<li><div style="text-align:justify;"><span style="font-size:11pt;">a balance between several R66 servers (thus leading to less risk of "high throughput side effects")</span> </div></li>

<li><div style="text-align:justify;"><span style="font-size:11pt;">a high availability in the sens that if one server is down in the pool, the others will ensure the continuity of the service</span> </div></li>

<li>
<div style="text-align:justify;"><span style="font-size:11pt;">a restart on disconnection (after a crash or stop of one server in the pool) using standard restart procedure of transfer, going to another server but as they all share at least the database, work and out directory, the transfer can restart easily</span></div></li></ul>
<p style="text-align:justify;"><span style="font-size:11pt;">However, a well enough service level could be sustained using simple monitoring on R66 server, forcing its stop/restart according to the results, giving almost the same result than cluster mode. </span></p>
<p style="text-align:justify;"><span style="font-size:11pt;">Indeed, when a server will retry a connection, it will respect a minimal delay between 2 checks, therefore the delay for the monitoring and restart is around this check delay or a factor of 2 of this delay. For instance, if the timeout/delay is setup to 30s, then the restart should occur in less than 60s to be almost equal to high availability.</span></p>
<p style="text-align:justify;"><span style="font-size:11pt;">Finally, <strong>regarding the database access</strong>, it is important to note that R66 monitors have a certain level of tolerance of unavailability of the database. As long as the transfer is not finishing, the database updates (which log the current status of the transfer) can be ignored. Each time, if the database connection is lost, the server will retry to open new connections when needed. However, when the transfer is finishing (in error or correct), the R66 server MUST save the status, and therefore, if it cannot, it sends back to its partner an internal erropr and will keep this transfer status as it was the las time it was saved. The next time this transfer will be restarted, it will restart form the point saved in the database.</span></p>
<p style="text-align:justify;"></p>
<p style="text-align:justify;"></p>
<p style="text-align:justify;"></p>
<p style="text-align:justify;"></p>
<p style="text-align:justify;">&nbsp;</p></div></td></tr></tbody></table>
<div id="Comp7_CodeRelayer"><script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-1693657-4";
urchinTracker();
</script>
</div></div>
</body>
</html>
